<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>拆红包</title><script src="https://by-health-cdn.oss-cn-beijing.aliyuncs.com/region/regions.js"></script><script src="./../data/redenvelope/prizes1.js"></script><script src="./../data/redenvelope/prizes2.js"></script><script src="./../data/redenvelope/themedata1.js"></script><script src="./../data/redenvelope/themedata2.js"></script><script src="./../data/redenvelope/themedata3.js"></script><style>body,
    html {
      height: 100%;
      width: 100%;
      overflow: hidden;
      padding: 0;
      margin: 0;
    }

    .box {
      width: 18.56em;
      height: 30.656em;
      margin: 0 auto;
    }

    .box1 {
      width: 18.56em;
      height: 30.656em;
      margin: 0 auto;
      position: relative;
    }

    #parentId1,
    #parentId2 {
      width: 100%;
      height: 100%;
      transform: none;
    }

    .clearfix:before,
    .clearfix:after {
      content: "";
      display: table;
    }

    .clearfix:after {
      clear: both;
    }

    #app {
      height: 100%;
      width: 100%;
      overflow: auto;
      -webkit-overflow-scrolling: touch;
    }

    h3 {
      padding-top: 1em;
      padding-left: 1em;
    }

    .transform{
      transform: none !important;
    }</style></head><body><div id="app"><div class="clearfix" style="padding-bottom: 50px; padding-top: 10px;"><h3>常规红包</h3><div class="box"><div id="parentId1"></div></div><h3>弹窗红包</h3><div style="text-align: center"><button id="modalRedEnvelope" style="background-color:#aaa; text-align: center; padding: 0.5em 2em; margin-top:0.5em">点击</button></div><br><br><br><h3>---</h3><div class="box1"><div id="parentId2"></div></div></div></div><script type="text/javascript" src="../lib/redenvelope.js?505efa9b885c1f15f161"></script></body><script>var isPC = !(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i));
  var W = window.innerWidth;
  var rate = window.innerWidth / 24;
  document.body.style.fontSize = isPC ? '16px' : rate + 'px';
  var prizesData1 = window.prizes1;
  var prizesData2 = window.prizes2;
  var rand = 7;
  var Game = window.___Lottery___.redenvelope.Game;
  var NoticeModal = window.___Lottery___.redenvelope.NoticeModal;
  var Modal = ___Lottery___.redenvelope.Modal;

  var start1 = function () {
    return new Promise(function (resolve) {
      window.LotteryGame1.Loading.show();
      window.setTimeout(function () {
        window.LotteryGame1.Loading.hide();
        const randId = Math.floor(Math.random() * rand);
        resolve(prizes1[randId]);
      }, 1000);
    });
  }


  var start2 = function () {
    return new Promise(function (resolve) {
      window.LotteryGame2.Loading.show();
      window.setTimeout(function () {
        window.LotteryGame2.Loading.hide();
        resolve(prizes2[7]);
      }, 1000);
    });
  }


  var saveAddress = function (data) {
    return new Promise(function (resolve) {
      window.LotteryGame1.Loading.show();
      window.setTimeout(function () {
        console.log('data', data);
        console.log('saveAddress');
        window.LotteryGame1.Loading.hide();
        resolve();
      }, 3000);
    });
  }

  var checkVerificationCode = function (data) {
    return new Promise(function (resolve) {
      window.LotteryGame1.Loading.show();
      window.setTimeout(function () {
        window.LotteryGame1.Loading.hide();
        resolve();
      }, 1000);
    });
  }


  var receiverInfo = {
    idCard: "430522201008124611",
    receiverPhone: "13622841234",
    address: "address"
  };

  var data1 = {
    // targetId: "target1",
    parentId: "parentId1",
    playerPhone: "13635219421",
    cardIdRequest: 3, // 填写收货地址时是否验证身份证: this.cardIdRequest = 1 隐藏身份证，2 验证身份证，3 身份证为空时不验证有填写时验证，4 不验证身份证
    style: window.themedata1,
    start: start1,
    saveAddress: saveAddress,
    receiverInfo: receiverInfo,
    checkVerificationCode: checkVerificationCode, // 检查手机验证码
    prizes: prizesData1.slice(0, rand),
    // emBase: 10,
    onCancel: function () { console.log('放弃1') },
    onEnsure: function (prize) { console.log('确定中奖结果1！', prize); },
    loading: {
      size: 20,
      length: 5,
      cycleTime: 1,
    },
    lotteryForms: {
      action: function (prize) {
        return new Promise(function (resolve, reject) {
          console.log('处理你的中奖形式', prize)
          resolve();
        })
      },
      template: '<div id="test">7777</div>',
      launcher: '#test'
    }
  };

  var data2 = {
    targetId: "target2",
    parentId: "parentId2",
    playerPhone: "13635219421",
    cardIdRequest: 3, // 填写收货地址时是否验证身份证: this.cardIdRequest = 1 隐藏身份证，2 验证身份证，3 身份证为空时不验证有填写时验证，4 不验证身份证
    style: window.themedata2,
    start: start2,
    saveAddress: saveAddress,
    receiverInfo: receiverInfo,
    // checkVerificationCode: checkVerificationCode, // 检查手机验证码
    prizes: prizesData2,
    failedModalTitle: "...",
    successModalTitle: "恭喜您抽中",
    submitFailedText: "好吧~~~",
    onCancel: function () { console.log('放弃2') },
    onEnsure: function (prize) { console.log('确定中奖结果2！', prize); },
    loading: {
      size: 20, // loading大小 默认20
      length: 5, // 由几个vertices组成默认12个
      cycleTime: 0.5
    }
  };

  var data3 = {
    targetId: "target3",
    parentId: "parentId3",
    playerPhone: "13635219421",
    cardIdRequest: 3, // 填写收货地址时是否验证身份证: this.cardIdRequest = 1 隐藏身份证，2 验证身份证，3 身份证为空时不验证有填写时验证，4 不验证身份证
    style: window.themedata3,
    start: start1,
    saveAddress: saveAddress,
    receiverInfo: receiverInfo,
    checkVerificationCode: checkVerificationCode, // 检查手机验证码
    prizes: prizesData1.slice(0, rand),
    // emBase: 10,
    onCancel: function () { console.log('放弃1') },
    onEnsure: function (prize) { console.log('确定中奖结果1！', prize); },
    loading: {
      size: 20,
      length: 5,
      cycleTime: 1,
    },
    lotteryForms: {
      action: function (prize) {
        return new Promise(function (resolve, reject) {
          console.log('处理你的中奖形式', prize)
          resolve();
        })
      },
      template: '<div id="test">7777</div>',
      launcher: '#test'
    }
  };

  window.LotteryGame1 = new Game(data1);
  window.LotteryGame2 = new Game(data2);

  window.myNoticeModal = new Modal({
    id: 'modal1', // 模板节点id 不传可自动生成id
    closable: true, // 可关闭 默认true
    shouldCloseOnOverlayClick: false, // 点击背景层关闭弹窗 默认false
    style: { // 定义modal样式 {overlay: 覆盖层, content: 内容区, close: 关闭按钮}
      overlay: {
        backgroundColor: 'rgba(0,0,0,0.5)',
        position: 'fixed'
      },
      header: {
        borderBottom: '1px solid #eee'
      },
      article: {
        width: '20em',
        height: '30em',
      },
      content: {
        backgroundColor: 'rgba(255, 255, 255, 0)',
        borderRadius: '0.5em',
        // 设置内容的层级关系
        zIndex: 107
      },
      "close": {
        "backgroundImage": "url('http://by-health-portal2.oss-cn-beijing.aliyuncs.com/images/20190418163518166.png')",
        "backgroundSize": "contain",
        "backgroundRepeat": "no-repeat",
        "width": "2.08em",
        "height": "2.08em",
        "top": ".5em",
        "right": ".5em",
        "marginLeft": "-1.04em",
        "zIndex": '110 !important'
      },
    },
    onCancel: function () {
    }
  });

  function showMyModal() {
    window.myNoticeModal.create({
      article: '<div id="parentId3" style="width:100%;height:100%"></div>'
    })
    .then(function(){
      var hackDom = document.getElementById(window.myNoticeModal.state.id).querySelector('.' + window.myNoticeModal.state.id + '_content');
      hackDom.classList.add('transform')
    });
    window.LotteryGame3 = new Game(data3);
  }

  showMyModal();
  document.getElementById('modalRedEnvelope').onclick = function () {
    showMyModal();
  }</script></html>